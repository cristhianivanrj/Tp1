package test;

import static org.junit.Assert.*;

import java.sql.SQLException;

import org.hamcrest.Matchers;
import org.junit.Assert;
import org.junit.Rule;

//import junit.framework.Assert;

import org.junit.Test;
import org.junit.rules.ExpectedException;

import com.mysql.jdbc.Connection;
import dados.Conexao2;

public class Conexao2Test {
	private static final String bd= "camilaBD";
	private static final String user= "camila";
	private static final String invalidUser = "Mafer";
	private static final String password= "camila";
	private static final String InvalidPassword= "cam";
	private Conexao2 conexao;
	
	@Rule
	public ExpectedException exception = ExpectedException.none();

	@Test
	public void testConexaoOk() {
		//fail("Not yet implemented");
		conexao =new Conexao2(bd,user,password);
		java.sql.Connection conn = null;
		try {
			conn =conexao.getConexao();
		} catch (SQLException e) {
			//e.printStackTrace();
			Assert.fail("Conexao ok ");
		}
		Assert.assertThat(conn, Matchers.notNullValue());		
	}
	
	@Test 
	public void testConexaoErr(){
		conexao = new Conexao2(bd,invalidUser,InvalidPassword);
		java.sql.Connection conn = null;		
		try {
			conn = conexao.getConexao();
			//Assert.fail("La conexao tem falha");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			//e.printStackTrace();
			Assert.assertThat(e, Matchers.isA(SQLException.class));
			Assert.assertThat(e.getMessage(), Matchers.startsWith("Access denied"));
			Assert.assertThat(e.getMessage(), Matchers.containsString("Access denied"));
		}
		Assert.assertThat(conn, Matchers.nullValue());
	}
	
	
//	@Test(expected = SQLException.class)
//	public void testConexaoErrAnotacoes() throws SQLException{
//		conexao = new Conexao2(bd,invalidUser,InvalidPassword);
//		conexao.getConexao();
//		}
	
	
	@Test
	public void testConexaoErrRegras() throws SQLException{
		exception.expect(SQLException.class);
		conexao = new Conexao2(bd,user,password);
		conexao.getConexao();
		}



}
